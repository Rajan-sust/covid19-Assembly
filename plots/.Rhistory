strip.background =element_rect(fill="white"),
legend.position = "bottom") +
guides(color = guide_legend(override.aes = list(size = 3)))
ggsave("Scatter_misasm_dupliR.pdf", width = 24, height = 10, units = "cm")
s3 %>% group_by(asm, assay) %>%
summarise(count = n())
# genomic feature
x4 = xm %>% filter(Assembly == "genomic features")
x4$value.1 = gsub("part", "", x4$value.1)
x5 = data.frame(str_split_fixed(x4$value.1,"\\+", 2), x4)
x6 = data.frame(assembly = x5$X2, match = as.numeric(as.character(x5$X1.1)), mismatch = as.numeric(as.character(x5$X2.1)))
# need to add assay_type
ggplot(x6, aes(assembly, 100*(match/49))) +
geom_boxplot(aes(color = assembly)) +
geom_jitter(alpha = .5, width = .1, aes(color = assembly)) +
xlab("") +
ylab("% features mapped") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1))
ggsave("percent features mapped.pdf", width = 15, height = 10, units = "cm")
# k-mer quality
kmer = c("abyss21", "abyss63", "abyss99", "metavelvet21", "metavelvet63", "metavelvet99", "ray21", "ray63", "ray99", "velvet21", "velvet63", "velvet99")
xmk = xm %>% filter(X2 %in% kmer)
#global averge
kmer_stats = xmk %>%
group_by(Assembly, X2) %>%
summarise(mean = mean(value, na.rm = T),
median = median(value, na.rm = T),
sd = sd(value, na.rm = T),
count = n())
print(kmer_stats, n = Inf)
kmer_stats %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50",  "L50", "LA50")) %>%
ggplot( aes(X2, mean)) +
geom_col() +
facet_grid(Assembly~., scales = "free")
kmer_stats %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50",  "L50", "LA50")) %>%
ggplot( aes(X2, mean)) +
geom_col() +
facet_grid(Assembly~., scales = "free") +
xlab("") +
ylab("Mean") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1))
getwd()
ggsave("k-mer_stats.pdf", width = 10, height = 20, units = "cm")
ggsave("k-mer_stats.pdf", width = 15, height = 30, units = "cm")
ggsave("k-mer_stats.pdf", width = 25, height = 40, units = "cm")
# average qualily across all samples
avg = xm %>%
group_by(Assembly, X2) %>%
summarise(mean = mean(value, na.rm = T),
median = median(value, na.rm = T),
sd = sd(value, na.rm = T),
count = n())
print(avg, n = Inf)
dim(avg)
# average qualily across all samples
avg = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50",  "L50", "LA50")) %>%
group_by(Assembly, X2) %>%
summarise(mean = mean(value, na.rm = T),
median = median(value, na.rm = T),
sd = sd(value, na.rm = T),
count = n())
print(avg, n = Inf)
dim(avg)
#global averge
kmer_stats = xmk %>%
group_by(Assembly, X2) %>%
summarise(mean = mean(value, na.rm = T),
median = median(value, na.rm = T),
max = max(value, na.rm = T),
min = min(value, na.rm = T),
sd = sd(value, na.rm = T),
count = n())
print(kmer_stats, n = Inf)
# average qualily across all samples
avg = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50",  "L50", "LA50")) %>%
group_by(Assembly, X2) %>%
summarise(mean = mean(value, na.rm = T),
median = median(value, na.rm = T),
max = max(value, na.rm = T),
min = min(value, na.rm = T),
sd = sd(value, na.rm = T),
count = n())
print(avg, n = Inf)
# supplementary file 1
avg = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
group_by(Assembly, X2) %>%
summarise(mean = mean(value, na.rm = T),
median = median(value, na.rm = T),
max = max(value, na.rm = T),
min = min(value, na.rm = T),
sd = sd(value, na.rm = T),
count = n())
head(avg, n = Inf)
# supplementary file 1
avg = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T))
head(avg, n = Inf)
spread(avg, key, value, fill = NA)
spread(avg, key = X2, value, fill = NA)
spread(avg, key = "X2", value, fill = NA)
spread(avg, key = "X2", value = median, fill = NA)
spread(avg, key = "X2", value = median, fill = NA) %>%  dim()
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(avg, key = "X2", value = median, fill = NA)
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
head(med, n = Inf)
print(med, n = Inf)
write.table(med, "~/Documents/research/asm/covid19-Assembly/Supplementary_files/Median_Assembly_Quality_assemblers.tsv", quote = F, row.names = F)
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
print(med, n = Inf)
write.table(med, "~/Documents/research/asm/covid19-Assembly/Supplementary_files/Median_Assembly_Quality_assemblers.tsv", quote = F, row.names = F)
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
med = xm %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
med = xm %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
med = xm %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T))
head(med)
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
med = xm %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
med = xm %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
# supplementary file 1
med = xm %>% filter(Assembly %in% c("Genome fraction (%)", "Largest alignment", "Duplication ratio", "misassemblies", "N50", "NA50", "N75", "NA75", "L50", "LA50", "L75", "LA75")) %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
# supplementary file 1
med = xm %>%
group_by(Assembly, X2) %>%
summarise(median = median(value, na.rm = T)) %>%
spread(key = "X2", value = median, fill = NA)
print(med, n = Inf)
write.table(med, "~/Documents/research/asm/covid19-Assembly/Supplementary_files/Median_Assembly_Quality_assemblers.tsv", quote = F, row.names = F)
write.table(med, "~/Documents/research/asm/covid19-Assembly/Supplementary_files/Median_Assembly_Quality_assemblers.tsv", quote = F, row.names = F, sep = ",")
#x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/backup/bioRxiv_1074_assembly_report_PE_amplicon_viralRNA.tsv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
head(x)
View(x)
head(x)
View(x)
library(tidyverse)
setwd("~/Documents/research/asm/covid19-Assembly/plots/")
s = read.table("~/Documents/research/asm/covid19-Assembly/files/SpikeSNVsDetails.txt")
s2 = data.frame(str_split_fixed(s$V1, "_", 3), s)
#number of samples used for variant calling
length(unique(s2$X1))
s3 = s2 %>% group_by(X2, V5) %>%
summarise(n = n())
ggplot(s3, aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
## total count of variants
v = read.table("~/Documents/research/asm/covid19-Assembly/files/Variant_count_all_assembler.txt")
ggplot(v, aes(V1, V2, fill = V1)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 416 samples") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "none")
# variants per sample
df = read_csv("~/Documents/research/asm/covid19-Assembly/files/sample_variants_count.csv")
# replace -32 with NA
df[df == -32] <- NA
df2 = melt(df)
ggplot(df2, aes(variable, value)) +
geom_boxplot() +
xlab("") +
ylab("Variants per sample") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "none")
ggplot(df2, aes(variable, value)) +
geom_violin() +
xlab("") +
ylab("Variants per sample") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "none")
ggplot(df2, aes(variable, value)) +
geom_boxplot() +
xlab("") +
ylab("Variants per sample") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "none")
ggplot(s3, aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
head(s3)
unique(s3$X2)
# mega and meta
s3 %>% filter(X2 == "megahit" && X2 == "metaspades") %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
s3 %>% filter(X2 == "megahit" && X2 == "metaspades")
# mega and meta
s3 %>% filter(X2 == "megahit") %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 == "megahit | metaspades") %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 == "megahit" | "metaspades") %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 == "megahit" & X2 == "metaspades") %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
s3 %>% filter(X2 == "megahit" & X2 == "metaspades")
head(s3)
s3 %>% filter(X2 == "megahit")
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>% dim()
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
s3
s3 %>% filter(X2 %in% c("megahit", "metaspades"))
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>% sum(n)
330+50
325+11+56
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
coord_polar("y", start=0) +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
head(s3)
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
coord_polar("y", start=0) +
facet_grid(~X2) +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
coord_polar("y", start=0) +
facet_wrap(~X2) +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
facet_wrap(~X2) +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
# mega and meta
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>%
ggplot(aes(X2, n, fill = V5)) +
geom_bar(position="stack", stat="identity") +
xlab("") +
ylab("Total variants in 347 samples at Spike locus") +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "right")
s = read.table("~/Documents/research/asm/covid19-Assembly/files/SpikeSNVsDetails.txt")
head(s)
s2 = data.frame(str_split_fixed(s$V1, "_", 3), s)
head(s2)
head(s3)
# mega and meta had 100% spike
mgs = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_megahit_SRR.txt")
head(mgs)
mts = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_metaspades_SRR.txt")
ms = inner_join(mgs, mts)
s3 %>% filter(X2 %in% c("megahit", "metaspades")) %>% head()
head(s2)
ms_common = inner_join(ms, s2, by = c("V1" = "X1"))
head(ms_common)
ms_common = inner_join(ms, s2, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
View(ms_common)
head(s2)
se_temp = s2 %>% select(X1, X2, V5)
head(se_temp)
ms_common = inner_join(ms, s2_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
se_temp = s2 %>% select(X1, X2, V5)
head(s2_temp)
se_temp = s2 %>% select(X1, X2, V5)
head(se_temp)
ms_common = inner_join(ms, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
View(ms_common)
544/2
head(ms_common)
ms_common = left_join(ms, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
544/2
head(ms)
dim(ms)
mgs = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_megahit_SRR.txt")
mts = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_metaspades_SRR.txt")
ms = inner_join(mgs, mts)
ms = left_join(mgs, mts)
ms = inner_join(mgs, mts)
table(unique(mgs))
length(unique(mgs))
length(unique(mgs$V1))
length(unique(mts$V1))
length(duplicated(mts$V1))
table((duplicated(mts$V1)))
?inner_join
table((duplicated(mgs$V1)))
table((duplicated(mts$V1)))
((duplicated(mts$V1)))
head(ms)
ms_common = semi_join(ms, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
ms_common = semi_join(ms, se_temp, by = c("V1" = "X1"))
View(ms_common)
# mega and meta had 100% spike
t = read.table("~/Documents/research/asm/covid19-Assembly/files/intersected_samples_list.txt")
View(t)
((duplicated(mts$V1)))
((duplicated(mgs$V1)))
mgs = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_megahit_SRR.txt")
mgs = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_megahit_SRR.txt")
mts = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_metaspades_SRR.txt")
ms = inner_join(mgs, mts)
intersect(mgs$V1, mts$V1)
unique(intersect(mgs$V1, mts$V1))
length(unique(intersect(mgs$V1, mts$V1)))
ms = inner_join(mgs, mts)
head(ms)
ms = inner_join(mgs, mts) %>% distinct()
se_temp = s2 %>% select(X1, X2, V5)
ms_common = left_join(ms, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
285*2
length(unique(intersect(ms$V1, se_temp$V1)))
head(ms)
head(se_temp)
length(unique(intersect(ms$V1, se_temp$X1)))
257*2
mts = read.table("~/Documents/research/asm/covid19-Assembly/files/spike_intersected_metaspades_SRR.txt")
table(duplicated(mgs))
table(duplicated(mgs))
table(duplicated(mts))
duplicated(mts)
mts[!duplicated(mts)]
mts[duplicated(mts)]
mts[duplicated(V1)]
mts[duplicated(mts$V1), ]
View(t)
mts[!duplicated(mts$V1), ]
mts2 = data.frame(mts[!duplicated(mts$V1), ])
head(mts2)
mts2 = data.frame(V1 = mts[!duplicated(mts$V1), ])
head(mts2)
length(unique(intersect(mgs$V1, mts2$V1)))
length(unique(intersect(mgs$V1, mts2$V1)))
ms = inner_join(mgs, mts) %>% distinct()
dim(ms)
se_temp = s2 %>% select(X1, X2, V5)
ms = inner_join(mgs, mts2) %>% distinct()
mg = left_join(mgs, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
mt = left_join(mts2, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit", "metaspades"))
head(mt)
head(mg)
ms_common = left_join(mg, mt, by = c("V1" = "V1")) %>% filter(X2 %in% c("megahit", "metaspades"))
ms_common = left_join(mg, mt, by = c("V1" = "V1"))
ms_common = inner_join(mg, mt, by = c("V1" = "V1"))
View(ms_common)
ms_common = anti_join(mg, mt, by = c("V1" = "V1"))
View(ms_common)
ms_common = left_join(mg, mt, by = c("V1" = "V1"))
View(ms_common)
length(unique(intersect(mg$V1, mt$V1)))
length(unique(intersect(mg$V1, mt$V1)))
View(mg)
mg = left_join(mgs, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c("megahit"))
mt = left_join(mts2, se_temp, by = c("V1" = "X1")) %>% filter(X2 %in% c( "metaspades"))
length(unique(intersect(mg$V1, mt$V1)))
ms_common = left_join(mg, mt, by = c("V1" = "V1"))
222*2
ms_common = inner_join(mg, mt, by = c("V1" = "V1"))
View(ms_common)
