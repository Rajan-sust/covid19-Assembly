#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
list = as.vector(m2$sample_id)
matchExpression <- paste(list, collapse = "|")
# [1] "foo|bar"
cll2 = cll %>% select(matches(matchExpression))
View(cll2)
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
list = as.vector(m2$sample_id)
matchExpression <- paste(list, collapse = "|")
# [1] "foo|bar"
cll2 = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll2)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll2))))
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% filter(str_detect(ig_status, "mutated"))
#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
list = as.vector(m2$sample_id)
matchExpression <- paste(list, collapse = "|")
# [1] "foo|bar"
cll2 = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll2)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll2))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
anno
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
dev.off()
plot.new()
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% filter(str_detect(ig_status, "mutated"))
#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
list = as.vector(m2$sample_id)
matchExpression <- paste(list, collapse = "|")
# [1] "foo|bar"
cll2 = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll2)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll2))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% filter(str_detect(ig_status, "mutated"))
#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
list = as.vector(m2$sample_id)
matchExpression <- paste(list, collapse = "|")
# [1] "foo|bar"
cll2 = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll2)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll2))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row", gaps_col = 27)
#dev.off()
plot.new()
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row", gaps_col = 27)
#dev.off()
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row", gaps_col = 27)
#dev.off()
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% filter(str_detect(ig_status, "mutated"))
#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
list = as.vector(m2$sample_id)
matchExpression <- paste(list, collapse = "|")
# [1] "foo|bar"
cll2 = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, cll2)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll2))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
colnames(x2)
matchExpression
list = as.vector(m2$sample_id)
list
head(m2)
u = m %>% filter(ig_status == "cll_unmutated")
View(u)
#m2 = m %>% filter(str_detect(ig_status, "mutated"))
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
mlist = as.vector(m2$sample_id)
View(m2)
#m2 = m %>% filter(str_detect(ig_status, "mutated"))
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
m2 = m %>% filter(ig_status == "cll_mutated")
View(m2)
mlist = as.vector(m2$sample_id)
#m2 = m %>% filter(str_detect(ig_status, "mutated"))
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
View(m2)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
#m2 = m %>% filter(str_detect(ig_status, "mutated"))
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
m2 = m %>% filter(ig_status == "cll_mutated")
mlist = as.vector(m2$sample_id)
matchExpression <- paste(ulist, collapse = "|")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
matchExpression <- paste(ulist, collapse = "|")
ucll = cll %>% select(matches(matchExpression))
matchExpression <- paste(ulist, collapse = "|")
ucll = cll %>% select(matches(matchExpression))
matchExpression <- paste(mlist, collapse = "|")
mcll = cll %>% select(matches(matchExpression))
head(mcll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
colnames(x2)
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
#m2 = m %>% filter(str_detect(ig_status, "mutated"))
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
m2 = m %>% filter(ig_status == "cll_mutated")
mlist = as.vector(m2$sample_id)
#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
#list = as.vector(m2$sample_id)
matchExpression <- paste(ulist, collapse = "|")
ucll = cll %>% select(matches(matchExpression))
matchExpression <- paste(mlist, collapse = "|")
mcll = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, ucll, ucll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
ulist
mlist
intersect(ucll, mcll)
intersect(ulist, mlist)
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
#m2 = m %>% filter(str_detect(ig_status, "mutated"))
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
m2 = m %>% filter(ig_status == "cll_mutated")
mlist = as.vector(m2$sample_id)
#manually add CLL in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
matchExpression <- paste(ulist, collapse = "|")
ucll = cll %>% select(matches(matchExpression))
matchExpression <- paste(mlist, collapse = "|")
mcll = cll %>% select(matches(matchExpression))
colnames(mcll)
colnames(ucll)
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, ucll, ucll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
duplicated(colnames(x2))
x2 = cbind(nbc, gcb, mbc, pbc, ucll, mcll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
colnames(x2)
colnames(ucll)
colnames(mcll)
View(m)
m %>% filter(paired_or_single = "SINGLE")
m %>% filter(m$paired_or_single = "SINGLE")
m %>% filter(paired_or_single == "SINGLE")
m %>% filter(paired_or_single == "SINGLE") %>% na.omit()
test = m %>% filter(paired_or_single == "SINGLE") %>% na.omit()
View(test)
head(m)
colnames(mcll)
colnames(ucll)
m = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796")
# correct mislabels
# manually add cll and gcbc to cemt samples
u = c("EGAN00001202787", "EGAN00001202788")
m = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CLL_97", "CLL_93", "CLL_96", "CLL_94", "CLL_6", "CLL_28", "CLL_5", "CLL_26", "CLL_25",  "CLL_1")
m = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CLL_97", "CLL_93", "CLL_96", "CLL_94", "CLL_6", "CLL_28", "CLL_5", "CLL_26", "CLL_25",  "CLL_1")
u = c("EGAN00001202787", "EGAN00001202788", "CLL_92", "CLL_95", "CLL_30", "CLL_27", "CLL_29", "CLL_4")
m = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CLL_97", "CLL_93", "CLL_96", "CLL_94", "CLL_6", "CLL_28", "CLL_5", "CLL_26", "CLL_25",  "CLL_1")
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
x = m
d = m
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CLL_92", "CLL_95", "CLL_30", "CLL_27", "CLL_29", "CLL_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CLL_97", "CLL_93", "CLL_96", "CLL_94", "CLL_6", "CLL_28", "CLL_5", "CLL_26", "CLL_25",  "CLL_1")
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CLL_92", "CLL_95", "CLL_30", "CLL_27", "CLL_29", "CLL_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CLL_97", "CLL_93", "CLL_96", "CLL_94", "CLL_6", "CLL_28", "CLL_5", "CLL_26", "CLL_25",  "CLL_1")
m$Cell <- ifelse(d$Sample %in% ucll, "uCLL",
ifelse(d$Sample %in% mcll, "mCLL",
ifelse(grepl("GCBC", d$Sample, ignore.case = T), "GCBC",
ifelse(grepl("csMBC", d$Sample, ignore.case = T), "MBC",
ifelse(grepl("HMPC", d$Sample, ignore.case = T), "HMPC",
ifelse(grepl("NBC", d$Sample, ignore.case = T), "NBC",
ifelse(grepl("PBC", d$Sample, ignore.case = T), "PBC",
ifelse(grepl("PreBC", d$Sample, ignore.case = T), "PreBC",
ifelse(grepl("MBC", d$Sample, ignore.case = T), "MBC", "nothing")))))))))
head(m)
m$Cell <- ifelse(m$sample_id %in% un, "cll_unmutated",
ifelse(m$sample_id %in% mu, "cll_mutated", "NA"))
View(m)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m$Cell <- ifelse(m$sample_id %in% un, "cll_unmutated",
ifelse(m$sample_id %in% mu, "cll_mutated", "NA"))
m = read_csv("~/Documents/research/cll/data/metadata_table")
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m$Cell <- ifelse(m$sample_id %in% un, "cll_unmutated",
ifelse(m$sample_id %in% mu, "cll_mutated", "NA"))
View(m)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m$Cell <- ifelse(m$sample_id %in% un, "cll_unmutated",
ifelse(m$sample_id %in% mu, "cll_mutated", ""))
View(m)
write_csv(m, "~/Documents/research/cll/data/metadata_table_corrected.csv")
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m$Cell <- ifelse(m$sample_id %in% un, "cll_unmutated",
ifelse(m$sample_id %in% mu, "cll_mutated", "NA"))
write_csv(m, "~/Documents/research/cll/data/metadata_table_corrected.csv")
head(m)
colnames(m)
m2 = m %>% -select(ig_status)
m2 = m %>% select(ig_status)
m2 = m %>% select(-ig_status)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% select(-ig_status)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m2$ig_status <- ifelse(m2$sample_id %in% un, "cll_unmutated",
ifelse(m2$sample_id %in% mu, "cll_mutated", "NA"))
write_csv(m2, "~/Documents/research/cll/data/metadata_table_corrected.csv")
?write_csv
head(m2)
colnames(m)
colnames(m2)
m3 = m2[,c(1:7,10,8:9)]
View(m3)
#manually replace NA with ""
write_csv(m3, "~/Documents/research/cll/data/metadata_table_corrected.csv")
xy.df <- data.frame(x = runif(10),  y = runif(10))
# pre-allocate a list and fill it with a loop
xy.list <- vector("list", nrow(xy.df))
for (i in 1:nrow(xy.df)) {
xy.list[[i]] <- xy.df[i,]
}
xy.list
head(xy.df)
xy.list <- split(xy.df, seq(nrow(xy.df)))
head(xy.df)
head(xy.list)
#manually replace NA with ""
write_csv(m3, "~/Documents/research/cll/data/metadata_table_corrected.csv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
library(tidygraph)
library(tidyverse)
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
head(x)
View(x)
# correlation
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
#x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/backup/bioRxiv_1074_assembly_report_PE_amplicon_viralRNA.tsv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
library(reshape2)
library(viridis)
library(ggsci)
#x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/backup/bioRxiv_1074_assembly_report_PE_amplicon_viralRNA.tsv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
head(x3)
temp = filter(Assembly == "Genome fraction (%)")
temp = filter(x3, Assembly == "Genome fraction (%)")
head(x3)
temp = filter(x3, Assembly == "Genome fraction (%)") %>% arrange(value)
head(temp)
temp = filter(x3, Assembly == "Genome fraction (%)") %>% arrange(-value)
head(temp)
View(temp)
library(tidyverse)
library(gdata)
x = read_tsv("~/GoogleDrive/T-ALL_manuscript/Experiment_Validation/CBP-P300-EZH2i/EBI_RUNX1.tsv")
x2 = t(x)
x3 = data.frame(tpm = x2[3:936,])
x4 = data.frame(cell = rownames(x3), tpm = as.numeric(as.character(x3$tpm)))
x5 = x4[order(x4$tpm),]
library(tidyverse)
library(gdata)
x = read_tsv("~/GoogleDrive/T-ALL_manuscript/Experiment_Validation/CBP-P300-EZH2i/EBI_RUNX1.tsv")
x = read_tsv("~/Documents/research/tall/T-ALL_manuscript/Experiment_Validation/CBP-P300-EZH2i/EBI_RUNX1.tsv")
x2 = t(x)
x3 = data.frame(tpm = x2[3:936,])
x4 = data.frame(cell = rownames(x3), tpm = as.numeric(as.character(x3$tpm)))
x5 = x4[order(x4$tpm),]
View(x5)
head(x)
y = read.table("~/Downloads/expression_atlas-homo_sapiens.tsv")
y = read.table("~/Downloads/expression_atlas-homo_sapiens.tsv", fill = T)
View(y)
library(tidyverse)
library(reshape2)
library(viridis)
library(ggsci)
#x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/backup/bioRxiv_1074_assembly_report_PE_amplicon_viralRNA.tsv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
temp = x3 %>% filter(Assembly == "Genome fraction (%)")
View(temp)
temp = x3 %>% filter(Assembly == "Genome fraction (%)")  %>% arrange(value)
temp = x3 %>% filter(Assembly == "Genome fraction (%)")  %>% arrange(-value)
library(tidyverse)
setwd("~/Documents/research/asm/covid19-Assembly/plots/")
#90%=29903*.9
contig = xm %>% filter(Assembly == "Largest contig") %>% filter(value >=26912.7)
#x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/backup/bioRxiv_1074_assembly_report_PE_amplicon_viralRNA.tsv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
temp = x3 %>% filter(Assembly == "Genome fraction (%)")  %>% arrange(-value)
meta = read_csv("~/Documents/research/asm/covid19-Assembly/files/PE_561samples_final.csv")
meta2 = meta %>% select(Run, Assay_Type)
xm = left_join(x3, meta2, by = c("X1" = "Run"))
#number of samples in each category
xm %>% distinct(variable, .keep_all = T) %>%
filter(Assembly == "contigs (>= 0 bp)") %>%
group_by(Assay_Type, X2) %>%
summarise(n = n()) %>%
filter(n == max(n)) %>%
distinct(Assay_Type, .keep_all = T)
#90%=29903*.9
contig = xm %>% filter(Assembly == "Largest contig") %>% filter(value >=26912.7)
View(contig)
setwd("~/Documents/research/asm/covid19-Assembly/plots/")
head(contig)
contig2 = group_by(X2) %>% summarise(count = n())
contig2 = contig %>% group_by(X2) %>% summarise(count = n())
View(contig2)
contig2
contig2
contig
#
contig2 = contig %>% group_by(X2, Assay_Type) %>% summarise(count = n())
contig2
print(contig2)
print(contig2, n = Inf)
