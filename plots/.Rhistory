x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
temp = x3 %>% filter(Assembly == "Genome fraction (%)")  %>% arrange(-value)
head(temp)
#mega
temp %>% filter(X2 == "megahit") %>% head(=10)
#mega
temp %>% filter(X2 == "megahit") %>% head(n=10)
#mega
temp %>% filter(X2 == "metaspades") %>% head(n=10)
temp %>% filter(value >=30) %>% dim()
temp %>% filter(value >=30) %>%
group_by(X2) %>%
summarise(n = n())
temp %>% filter(value >=50) %>%
group_by(X2) %>%
summarise(n = n())
temp %>% filter(value >= 50) %>%
group_by(X1) %>%
summarise(n = n())
temp %>% filter(value >= 10) %>%
group_by(X1) %>%
summarise(n = n())
temp %>% filter(value >= 20) %>%
group_by(X1) %>%
summarise(n = n())
temp %>% filter(value >= 20) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(n)
temp %>% filter(value >= 20) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 30) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 50) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 80) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 70) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 65) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 75) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 80) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 75) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
temp %>% filter(value >= 70) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
View(temp)
x = read.table("~/Documents/research//cll/data/AvgMeth_H3K27ac_CLL_enriched_over4cell_0.75percent.txt", head = F)
df = x %>% filter(V1 != "EGAN00001235812:MBC.2:csMBC.bed.combine.5mC.CpG") %>% filter(V1 != "EGAN00001286337:NBC.6:NC11_83.bed.combine.5mC.CpG") %>% filter(V1 != "CLL_29.bed.combine.5mC.CpG")
df$V1 <- gsub('.bed.combine.5mC.CpG', '', df$V1)
head(df)
View(df)
x = read.table("~/Documents/research/tall/T-ALL_manuscript/Data/SE/mne_5SE.bed.NumReads")
x
x2 = data.frame(ron = x$V5/61148753, roff = x$V6/68715022, non = x$V7/48017639, noff = x$V8/59238945)
x2
x2 = data.frame(ron = (x$V5/61148753)/(x$V6/68715022), non = (x$V7/48017639)/(x$V8/59238945))
x2
x2 = data.frame(ron = x$V5/61148753, roff = x$V6/68715022, non = x$V7/48017639, noff = x$V8/59238945)
x3 = data.frame(ron = (x$V5/61148753)/(x$V6/68715022), non = (x$V7/48017639)/(x$V8/59238945))
t.test(x2$ron, x2$roff)
t.test(x2$non, x2$noff)
wilcox.test(x2$ron, x2$roff)
t.test(x2$ron, x2$roff)
t.test(x2$non, x2$noff)
x3 = data.frame(ron = (x$V5/61148753)/(x$V6/68715022), non = (x$V7/48017639)/(x$V8/59238945))
x3
mean(x3$ron)
mean(x3$non)
ks.test(x2$ron, x2$roff)
?t.test
x2 = data.frame(ron = 444/61148753, roff = 303/68715022, non = 434/48017639, noff = 351/59238945)
t.test(x2$ron, x2$roff)
t.test(x2$non, x2$noff)
x = data.frame(ron = 444/61148753, roff = 303/68715022, non = 434/48017639, noff = 351/59238945)
x = data.frame(r.fc = (444/61148753)(303/68715022), n.fc = (434/48017639)/(351/59238945))
x
data.frame(r.fc = (444/61148753)(303/68715022), n.fc = (434/48017639)/(351/59238945))
data.frame(r.fc = (444/61148753)/(303/68715022), n.fc = (434/48017639)/(351/59238945))
data.frame(r.fc = (985/32663162)/(488/35120313), n.fc = (1504/45935803)/(1396/52821680))
library(tidyverse)
library(reshape2)
library(viridis)
library(ggsci)
#x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/backup/bioRxiv_1074_assembly_report_PE_amplicon_viralRNA.tsv")
x = read_tsv("~/Documents/research/asm/covid19-Assembly/files/report_metaquast_PE_all.tsv")
x2 = melt(x, id.vars = "Assembly")
x2$Assembly = gsub("# ", "", x2$Assembly)
x3 = data.frame(str_split_fixed(x2$variable, "_", 3), value = as.numeric(x2$value), x2)
# temp: query samples by %GF
temp = x3 %>% filter(Assembly == "Genome fraction (%)")  %>% arrange(-value)
#mega and mega
temp %>% filter(X2 == "megahit") %>% head(n=10)
temp %>% filter(X2 == "metaspades") %>% head(n=10)
temp %>% filter(value >= 70) %>%
group_by(X1) %>%
summarise(n = n()) %>%
arrange(-n)
# end temp
meta = read_csv("~/Documents/research/asm/covid19-Assembly/files/PE_561samples_final.csv")
meta2 = meta %>% select(Run, Assay_Type)
xm = left_join(x3, meta2, by = c("X1" = "Run"))
#number of samples in each category
xm %>% distinct(variable, .keep_all = T) %>%
filter(Assembly == "contigs (>= 0 bp)") %>%
group_by(Assay_Type, X2) %>%
summarise(n = n()) %>%
filter(n == max(n)) %>%
distinct(Assay_Type, .keep_all = T)
head(xm)
unique(xm$Assembly)
make_boxplot = function(variableToPlot)
{
x4 = xm %>% filter(Assembly == variableToPlot)
stat = x4 %>%
group_by(Assay_Type, X2) %>%
summarize(mean = mean(value, na.rm = TRUE),
median = median(value, na.rm = TRUE))
#kable(stat)
print(stat, n = Inf)
plot = ggplot(x4, aes(X2, value)) +
geom_jitter(alpha = .5, width = .1, aes(color = X2)) +
geom_boxplot(alpha = 0.1) +
#scale_color_viridis(discrete=TRUE) +
#scale_fill_material("red") +
xlab("") +
ylab(variableToPlot) +
facet_grid(Assay_Type~.) +
theme(panel.background = element_rect(fill = "white"),
panel.border = element_rect(fill = NA, colour = "black", size = .5),
axis.text = element_text(color = "black", angle = 90, hjust = 1),
strip.background =element_rect(fill="white"),
legend.position = "none")
print(plot)
filename = str_replace_all(variableToPlot, "[[:punct:]]", "")
ggsave(filename=paste(filename,".pdf", sep="_"), width = 12, height = 18, units = "cm", device = 'pdf')
}
make_boxplot("unaligned contigs")
make_boxplot("N's per 100 kbp")
make_boxplot("unaligned contigs")
make_boxplot("N's per 100 kbp")
make_boxplot("unaligned contigs")
View(xm)
unique(xm$Assembly)
make_boxplot("unaligned mis. contigs")
meta_file = read.csv("~/GoogleDriveCLL/data/EGA_metadata/EGA_metadata_remdup_WithFilePath.csv")
head(meta_file)
View(meta_file)
version
-.5>9
-.5>-9
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% select(-ig_status)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m2$ig_status <- ifelse(m2$sample_id %in% un, "cll_unmutated",
ifelse(m2$sample_id %in% mu, "cll_mutated", "NA"))
m3 = m2[,c(1:7,10,8:9)]
#manually replace NA with ""
#write_csv(m3, "~/Documents/research/cll/data/metadata_table_corrected.csv")
#end of correction
# manually add cll and gcbc to cemt samples
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
m2 = m %>% filter(ig_status == "cll_mutated")
mlist = as.vector(m2$sample_id)
#manually add CLL, GCBC in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
#list = as.vector(m2$sample_id)
matchExpression <- paste(ulist, collapse = "|")
ucll = cll %>% select(matches(matchExpression))
matchExpression <- paste(mlist, collapse = "|")
mcll = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, ucll, mcll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% select(-ig_status)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m2$ig_status <- ifelse(m2$sample_id %in% un, "cll_unmutated",
ifelse(m2$sample_id %in% mu, "cll_mutated", "NA"))
m3 = m2[,c(1:7,10,8:9)]
#manually replace NA with ""
#write_csv(m3, "~/Documents/research/cll/data/metadata_table_corrected.csv")
#end of correction
# manually add cll and gcbc to cemt samples
m2 = m %>% filter(ig_status == "cll_unmutated")
ulist = as.vector(m2$sample_id)
m2 = m %>% filter(ig_status == "cll_mutated")
mlist = as.vector(m2$sample_id)
#manually add CLL, GCBC in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput"))
#list = as.vector(m2$sample_id)
matchExpression <- paste(ulist, collapse = "|")
ucll = cll %>% select(matches(matchExpression))
matchExpression <- paste(mlist, collapse = "|")
mcll = cll %>% select(matches(matchExpression))
nbc = x %>% select(contains("NBC"))
gcb = x %>% select(contains("GCBC"))
mbc = x %>% select(contains("MBC"))
pbc = x %>% select(contains("PBC"))
x2 = cbind(nbc, gcb, mbc, pbc, ucll, mcll)
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("uCLL",ncol(ucll)), rep("mCLL",ncol(mcll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row")
#dev.off()
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% select(-ig_status)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m2$ig_status <- ifelse(m2$sample_id %in% un, "cll_unmutated",
ifelse(m2$sample_id %in% mu, "cll_mutated", "NA"))
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table")
m2 = m %>% select(-ig_status)
head(m2)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
m2$ig_status <- ifelse(m2$sample_id %in% un, "cll_unmutated",
ifelse(m2$sample_id %in% mu, "cll_mutated", "NA"))
head(m2)
# manually add cll and gcbc to cemt samples
m = read_csv("~/Documents/research/cll/data/metadata_table_corrected.csv")
m2 = m %>% select(-ig_status)
# correct mislabels
un = c("EGAN00001202787", "EGAN00001202788", "CEMT_92", "CEMT_95", "CEMT_30", "CEMT_27", "CEMT_29", "CEMT_4")
mu = c("EGAN00001202786", "EGAN00001202789", "EGAN00001235813", "EGAN00001265750", "EGAN00001295796", "CEMT_97", "CEMT_93", "CEMT_96", "CEMT_94", "CEMT_6", "CEMT_28", "CEMT_5", "CEMT_26", "CEMT_25",  "CEMT_1")
head(m2)
m2$ig_status <- ifelse(m2$sample_id %in% un, "cll_unmutated",
ifelse(m2$sample_id %in% mu, "cll_mutated", "NA"))
head(m2)
m3 = m2[,c(1:7,10,8:9)]
head(m3)
#manually add CLL, GCBC in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
View(x)
library(tidyverse)
library(pheatmap)
#manually add CLL, GCBC in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
colnames(x)
#manually add CLL, GCBC in CEMT samples
x = read_tsv("~/Documents/research//cll/data/heatmap/H3K27ac.mCLL_uCLL_matirx.tsv")
colnames()
colnames(x)
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788"))) %>% select(-contains("MACS2NoInput"))
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788")))
ucll = x %>% select(starts_with(c("EGAN00001202787")))
head(ucll)
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788")))
ucll = x %>% select(starts_with(c("EGAN00001202787", "CEMT_92")))
ucll = x %>% select(starts_with(c( "EGAN00001202788")))
iris %>% select(starts_with(c("Petal", "Sepal")))
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788"), fixed=TRUE))
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788"), fixed=F))
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788")), fixed=F)
ucll = x %>% select(starts_with(c("EGAN00001202787", "EGAN00001202788")))
ucll = x %>% select(contains(c("EGAN00001202787", "EGAN00001202788")))
version
#
x = read_tsv("~/Downloads/H3K27ac_CLL_matirx.tsv")
library(tidyverse)
library(pheatmap)
#
x = read_tsv("~/Downloads/H3K27ac_CLL_matirx.tsv")
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput")) %>% select(-starts_with("A."))
nbc = x %>% select(contains("NBC")) %>% select(-contains("MACS2NoInput"))
gcb = x %>% select(contains("GCBC")) %>% select(-contains("MACS2NoInput"))
mbc = x %>% select(contains("MBC")) %>% select(-contains("MACS2NoInput"))
pbc = x %>% select(contains("PBC")) %>% select(-contains("MACS2NoInput"))
x2 = cbind(nbc, gcb, mbc, pbc, cll)
table(duplicated(colnames(x2)))
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = F, scale = "row", gaps_col = 25)
colnames(cll)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = T, scale = "row", gaps_col = 25)
# manually add cll and gcbc to cemt samples
#works
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
# manually add cll and gcbc to cemt samples
#works
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
library(tidyverse)
library(pheatmap)
# manually add cll and gcbc to cemt samples
#works
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
#
#x = read_tsv("~/Downloads/H3K27ac_CLL_matirx.tsv")
#names(x) <- gsub(".CLL.intersect.value", "", names(x))
cll = x %>% select(contains("CLL")) %>% select(-contains("MACS2NoInput")) %>% select(-starts_with("A."))
nbc = x %>% select(contains("NBC")) %>% select(-contains("MACS2NoInput"))
gcb = x %>% select(contains("GCBC")) %>% select(-contains("MACS2NoInput"))
mbc = x %>% select(contains("MBC")) %>% select(-contains("MACS2NoInput"))
pbc = x %>% select(contains("PBC")) %>% select(-contains("MACS2NoInput"))
x2 = cbind(nbc, gcb, mbc, pbc, cll)
table(duplicated(colnames(x2)))
anno = data.frame("Cell" = c(rep("NBC",ncol(nbc)),rep("GCBC",ncol(gcb)),rep("MBC",ncol(mbc)),rep("PBC",ncol(pbc)), rep("CLL",ncol(cll))))
rownames(anno) = colnames(x2)
#plot.new()
#png("~/Documents/research//cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.png")
#pdf("~/Documents/research/cll/CLL_manuscript//plots/H3K27ac_CLL_heatmap.pdf")
pheatmap(x2, annotation_col = anno, cluster_rows = F, cluster_cols = F, show_rownames = F, show_colnames = T, scale = "row", gaps_col = 25)
#dev.off()
# manually add cll and gcbc to cemt samples
#works
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
head(x)
#
x = read_tsv("~/Downloads/H3K27ac_CLL_matirx.tsv")
head(x)
# manually add cll and gcbc to cemt samples
#works
x = read_tsv("~/Documents/research//cll/data/H3K27ac_CLL_matirx.tsv")
#
x_new = read_tsv("~/Downloads/H3K27ac_CLL_matirx.tsv")
View(x)
View(x_new)
colnames(x)
CEMT_94_CLL_H3K27ac.bed.intersect.value
colnames(x_new)
head(x_new$A60648_CEMT_94_CLL_H3K27ac_PAIRED.FINDER2.bed.intersect.value)
head(x$CEMT_94_CLL_H3K27ac.bed.intersect.value)
#
x_new = read_tsv("~/Downloads/H3K27ac_CLL_matirx.tsv")
head(x_new)
intersect(x$A..intersect.value, x_new$A0000.intersect.value)
setdiff(x$A..intersect.value, x_new$A0000.intersect.value)
x %>% select(contains(c(A..intersect.value, CEMT_94_CLL_H3K27ac.bed.intersect.value)))
x %>% select((A..intersect.value, CEMT_94_CLL_H3K27ac.bed.intersect.value)))
x %>% select(contains(c("A..intersect.value", "CEMT_94_CLL_H3K27ac.bed.intersect.value")))
x_new %>% select(contains(c(A..intersect.value, CEMT_94_CLL_H3K27ac.bed.intersect.value)))
x_new %>% select(contains(c("A0000.intersect.value", "CEMT_94")))
x_new %>% select(contains(c("A0000.intersect.value", "CEMT_27")))
x %>% select(contains(c("A..intersect.value", "CEMT_27")))
head(colnames(x))
(colnames(x))
x %>% select(contains(c("A..intersect.value", "EGAN00001360148_EGAX00001379562_EGAR00001416645")))
x_new %>% select(contains(c("A0000.intersect.value", "EGAN00001360148_EGAX00001379562_EGAR00001416645")))
(colnames(x))
?t.test
meta = read_csv("~/Documents/research/asm/covid19-Assembly/files/PE_561samples_final.csv")
library(pheatmap)
library(tidyverse)
meta = read_csv("~/Documents/research/asm/covid19-Assembly/files/PE_561samples_final.csv")
mh = read.table("~/Documents/research/asm/covid19-Assembly/files/megahit_alignment_matrix_50bp.tsv", head = F)
ms = read.table("~/Documents/research/asm/covid19-Assembly/files/metaspade_alignment_matrix_50bp.tsv", head = F)
ab = read.table("~/Documents/research/asm/covid19-Assembly/files/abyss63_alignment_matrix_50bp.tsv", head = F)
tr = read.table("~/Documents/research/asm/covid19-Assembly/files/trinity_alignment_matrix_50bp.tsv", head = F)
hs = cbind(mh, ms, ab, tr)
hst = data.frame(t(hs))
hst2 = hst %>% filter(X1 != "A.ID.megahit.50bp_overlap") %>%
filter(X1 != "A.ID.metaspade.50bp_overlap") %>%
filter(X1 != "A.ID.abyss63.50bp_overlap") %>%
filter(X1 != "A.ID.trinity.50bp_overlap")
hst3 = data.frame(str_split_fixed(hst2$X1, "_", 3), hst2)
megahit = hst3 %>% filter(hst3$X2.1 == "megahit") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
metaspades = hst3 %>% filter(hst3$X2.1 == "metaspades") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
abyss = hst3 %>% filter(hst3$X2.1 == "abyss63") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
trinity = hst3 %>% filter(hst3$X2.1 == "trinity") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
both = merge(megahit, metaspades, by.x = "X1.1", by.y = "X1.1")
both = inner_join(megahit, metaspades, by = c("X1.1" = "X1.1")) %>%
inner_join(abyss, by = c("X1.1" = "X1.1")) %>%
inner_join(trinity, by = c("X1.1" = "X1.1"))
both2 = inner_join(meta, both, by = c( "Run" = "X1.1"))
both3 = both2[, c(2,6, 15:ncol(both2))]
both3 %>% group_by(Assay_Type) %>%
summarise(n = n())
both4 = data.frame(both3[,3:ncol(both3)])
#conver factor to numeric
both5 = both4 %>%
mutate_all(~as.numeric(as.character(.)))
rownames(both5) = both3$Run
pheatmap(both5, annotation_row = anno, cluster_cols = F, cluster_rows = F, show_rownames = F, show_colnames = F, color = colorRampPalette(c("red", "white", "gray"))(1000), border_color = NA, gaps_col = c(599, 599+599, 599+599+599), gaps_row = c(81, 81+60, 81+60+41, 81+60+41+83))
#add annotation
anno = data.frame(Assay = both3$Assay_Type)
rownames(anno) = rownames(both5)
pheatmap(both5, annotation_row = anno, cluster_cols = F, cluster_rows = F, show_rownames = F, show_colnames = F, color = colorRampPalette(c("red", "white", "gray"))(1000), border_color = NA, gaps_col = c(599, 599+599, 599+599+599), gaps_row = c(82, 82+65, 82+65+58, 82+65+58+88))
head(both5)
View(both5)
library(pheatmap)
library(tidyverse)
meta = read_csv("~/Documents/research/asm/covid19-Assembly/files/PE_561samples_final.csv")
mh = read.table("~/Documents/research/asm/covid19-Assembly/files/megahit_alignment_matrix_50bp.tsv", head = F)
ms = read.table("~/Documents/research/asm/covid19-Assembly/files/metaspade_alignment_matrix_50bp.tsv", head = F)
ab = read.table("~/Documents/research/asm/covid19-Assembly/files/abyss63_alignment_matrix_50bp.tsv", head = F)
tr = read.table("~/Documents/research/asm/covid19-Assembly/files/trinity_alignment_matrix_50bp.tsv", head = F)
hs = cbind(mh, ms, ab, tr)
hst = data.frame(t(hs))
hst2 = hst %>% filter(X1 != "A.ID.megahit.50bp_overlap") %>%
filter(X1 != "A.ID.metaspade.50bp_overlap") %>%
filter(X1 != "A.ID.abyss63.50bp_overlap") %>%
filter(X1 != "A.ID.trinity.50bp_overlap")
hst3 = data.frame(str_split_fixed(hst2$X1, "_", 3), hst2)
megahit = hst3 %>% filter(hst3$X2.1 == "megahit") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
metaspades = hst3 %>% filter(hst3$X2.1 == "metaspades") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
abyss = hst3 %>% filter(hst3$X2.1 == "abyss63") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
trinity = hst3 %>% filter(hst3$X2.1 == "trinity") %>% select(-X2.1) %>% select(-X3.1) %>% select(-X1)
both = merge(megahit, metaspades, by.x = "X1.1", by.y = "X1.1")
both = inner_join(megahit, metaspades, by = c("X1.1" = "X1.1")) %>%
inner_join(abyss, by = c("X1.1" = "X1.1")) %>%
inner_join(trinity, by = c("X1.1" = "X1.1"))
both2 = inner_join(meta, both, by = c( "Run" = "X1.1"))
both3 = both2[, c(2,6, 15:ncol(both2))]
both3 %>% group_by(Assay_Type) %>%
summarise(n = n())
#write.table(both3, "~/Documents/research/asm/covid19-Assembly/files/megahit_metaspades_heatmap_matrix.tsv", sep = "\t", quote = F, row.names = F, col.names = F)
both4 = data.frame(both3[,3:ncol(both3)])
#conver factor to numeric
both5 = both4 %>%
mutate_all(~as.numeric(as.character(.)))
rownames(both5) = both3$Run
#pheatmap(both5, cluster_cols = F, cluster_rows = F, show_rownames = F, show_colnames = F, color = colorRampPalette(c("red", "white", "gray"))(1000), border_color = NA, gaps_col = 599)
#add annotation
anno = data.frame(Assay = both3$Assay_Type)
rownames(anno) = rownames(both5)
x <- cbind(x1 = 3, x2 = c(4:1, 2:5))
rowSums(x); colSums(x)
x
rowSums(x)
colSums(x)
dim(UCBAdmissions)
(UCBAdmissions)
tibble(UCBAdmissions)
colSums(both5)
#colmeans
cm = data.frame(colMeans(both5))
View(cm)
setwd("~/Documents/research/asm/covid19-Assembly/plots/")
#r = read.table("~/Documents/research/asm/covid19-Assembly/files//read_QC_matrix.txt")[,c(1,4)]
r = read.table("~/Documents/research/asm/covid19-Assembly/files/read_QC_matrix.txt")[,c(1,4)]
View(r)
r2 = data.frame(id = str_split_fixed(r$V1, "_", 2), read = r$V4)
#sum every two rows of PE data
r3 = data.frame(id = unique(r2$id.1), read = (rowsum(r2[,3], as.integer(gl(nrow(r2), 2, nrow(r2))))))
View(r3)
x = read.table("/Users/rashedulislam/Documents/research/asm/bam/bwa_alignment/disagreement_MetaSpades_Megahit/merged_vcf/agree_disagree.bed.readcount")
View(x)
x %>% select(V8)
x %>% select(V10, V4)
x %>% select(V10, V4) %>%
geom_boxplot(aes(V4, V10))
x %>% select(V10, V4) %>%
ggplot(aes(V4, V10)) +
geom_boxplot()
x %>% select(V10, V4) %>%
ggplot(aes(V4, V11)) +
geom_boxplot()
x %>% select(V11, V4) %>%
ggplot(aes(V4, V11)) +
geom_boxplot()
x %>% select(V12, V4) %>%
ggplot(aes(V4, V12)) +
geom_boxplot()
